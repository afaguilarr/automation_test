## ðŸš€ Getting Started

1. **Start development environment locally.**

Navigate into your new site's directory and start it up, following the commands below

```sh
git clone https://github.com/SomoGlobal/automation_test.git
yarn install
yarn develop
```

2. **Open the code and start testing & automating !**

Your site is now running at `http://localhost:8000`!


## ðŸ“ Requirements

1. **Test the site using Cypress or Selenium, feel free to choose what you consider important (useful) to automate**

Bonus if you leave comments on your code

2. **Provide your automation tests to our recruitment team (github link from your personal github / gitlab account) OR zip file**

# About the Solution

The automated tests created to test the provided site were developed using Cypress, the following text aims to explain how this was developed and why it was done this way.

## Repo Structure

* The trees shown in the current section were generated by using the [tree](https://www.cyberciti.biz/faq/linux-show-directory-structure-command-line/) bash command.
* The following tree shows the new stuff that was added.
  ```
  automation_test
  â”œâ”€â”€ CHANGELOG.md
  â”œâ”€â”€ Dockerfile => NEW
  â”œâ”€â”€ LICENSE
  â”œâ”€â”€ README.md => MODIFIED
  â”œâ”€â”€ content
  â”œâ”€â”€ docker-compose.yml => NEW
  â”œâ”€â”€ gatsby-config.js
  â”œâ”€â”€ package-lock.json
  â”œâ”€â”€ package.json
  â”œâ”€â”€ public
  â”œâ”€â”€ src
  â”œâ”€â”€ static
  â””â”€â”€ test => NEW 
  ```
  * The `README.md` file was of course modified in order to explain the work done.
  * Some `docker` files were added in order to make this executable for someone without `node/npm/yarn` installed on their machine or probably for Continuous integration purposes.
    * A `Dockerfile` to build the UI code.
    * A `docker-compose.yml` file to configure the swarming between the UI and the tests execution.
      * There will be further explanation about how these work in the last section.
  * A `test` directory was added to the existing repository in order. This way it's easier to setup both the development code and the testing code at the same time.
    * This directory includes all the code and documentation related to the developed UI tests.
      ```
      test
      â”œâ”€â”€ Dockerfile
      â”œâ”€â”€ cypress
      â”œâ”€â”€ cypress.json
      â”œâ”€â”€ features
      â””â”€â”€ package.json
      ```
      * A `Dockerfile` containing the instructions to build the testing code.
      * A `cypress.json` file containing all the necessary configurations for the cypress tests to be executed.
      * A `features` directory containing all the gherkin scenarios that were automated. Note: they were not automated using cucumber, these are just documentation files that helped me to know what I should test.
      * A `package.json` file containing all the dependencies necessary for the automation code to work.
      * A `cypress` directory containing all the cypress code.
        ```
        cypress
        â”œâ”€â”€ fixtures
        â”œâ”€â”€ integration
        â”œâ”€â”€ plugins
        â””â”€â”€ support
        ```
        * The `fixtures` directory contains some static data needed for testing.
        * The `integration` directory contains all the test `spec.js` files.
        * The `plugins` directory contains the functions needed to generate fake data.
        * The `support` directory contains all the reusable code.
  
## Testing approach

* I like to begin by making manual test plans, I'm mostly used to do this using gherkin but I could use some platform like testrails, zephyr (JIRA), testlink, among others. That's why you'll find a lot of `.feature` gherkin files in the `test/features` directory.
  
  These describe the behaviors I expected for each page `about, projects, instagram, home, etc...`

* Each page has some `content` and `redirections` `.spec.js` files that test the expected content and redirections for each page.

  The most interesting tests can be found here `test/cypress/integration/instagram/instagramGrid.spec.js`, since they intercept one of the gatsby API calls to be able to control the data that will be received, and faking that data makes sure that we'll always test different values.
  
  Other interesting tests to check are the ones inside the subdirectories of `test/cypress/integration/projects` since they get the necessary data from some `.json` files in the `test/cypress/fixtures` directory.
  
* **NOTES:**
  
  **Please take into account that all the `.spec.js` files should be reflected by a `.feature` file.**
  
  **I think I found a bug with this automation, so there is one specific test failing. The `A proper error page is shown when a non-existent url is requested` test in the `test/cypress/integration/errors/notFound.spec.js` spec file and the `test/features/errors/notFound.feature` feature file.**
  
## How to run these tests

* Clone this repo.

* To run the tests using yarn, just run the following commands (executing the tests in this way will generate videos, screenshots and an HTML report):
  * `yarn install` to install all dependencies.
  * `yarn develop` to start the app with the provided development code.
  * `cd test` and `yarn install` to install the testing packages.
  * `cd ..` and `yarn test`. Electron will be used as browser by default.
  * If you want to run the tests in a specific browser use the prefix browser as follows: `BROWSER=chrome yarn test` or `BROWSER=electron yarn test`.
  * Take into account that electron executions are by default headless, but chrome is headed by default, so to execute them in a specific mode, use the following commands: `HEADLESS=headless yarn test` or `HEADLESS=headed yarn test`.
  * You can also combine both flags like the following example: `BROWSER=chrome HEADLESS=headless yarn test`.
  
  NOTES:
  * After running the tests in this way, the `test/cypress/report`, `test/cypress/screenshots` and `test/cypress/videos` folders will be created, please check them for any necessary extra info, a really useful mochawesome HTML report is being generated in the `test/cypress/mochawesome-report/mochawesome.html` file!
  * Check the `scripts` section in the `package.json` file to check how the `yarn test` command works.  

* To run the tests in the cypress UI, just run the following commands:
  * `yarn install` to install all dependencies.
  * `yarn develop` to start the app with the provided development code.
  * `cd test` and `yarn install` to install the testing packages.
  * `npx cypress open` to open the cypress UI.

* To run tests using docker, just run the following commands (executing the tests in this way will generate videos, screenshots and an HTML report).
  * `docker-compose build`.
  * `docker-compose up`. Electron will be used as browser by default.
  * If you want to run the tests in a specific browser use the prefix browser as follows: `BROWSER=chrome docker-compose up` or `BROWSER=electron docker-compose up` just these 2 browsers are supported by the docker execution.
  * Docker runs will always be headless.
  
  NOTES:
    * After running the tests in this way, the `test/cypress/report`, `test/cypress/screenshots` and `test/cypress/videos` folders will be created, please check them for any necessary extra info, a really useful mochawesome HTML report is being generated in the `test/cypress/mochawesome-report/mochawesome.html` file!
    * Check the `Dockerfile` and `test/Dockerfile` files to check how the `docker-compose build` command works. 
    * Check the `command` sections in the `docker-compose.yml` file to check how the `docker-compose up` command works.
